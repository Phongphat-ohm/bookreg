# ระบบจัดการบุคลากรและกลุ่มสาระการเรียนรู้

## ฟีเจอร์ที่ได้ปรับปรุง

### 1. ระบบจัดการบุคลากร (ครู)
- **แสดงกลุ่มสาระที่ครูอยู่**: แสดงชัดเจนว่าครูเป็นหัวหน้ากลุ่มสาระใด หรือไม่ได้เป็นหัวหน้า
- **จัดการกลุ่มสาระ**: มีปุ่ม "จัดการกลุ่มสาระ" ในแต่ละครู
- **สร้างครูใหม่**: ไม่จำเป็นต้องระบุกลุ่มสาระตอนสร้าง สามารถเพิ่มทีหลังได้
- **แสดงสถิติ**: แสดงจำนวนวิชาที่สอน และห้องที่ปรึกษา

### 2. ระบบจัดการกลุ่มสาระ
- **เปลี่ยนหัวหน้ากลุ่มสาระ**: สามารถเปลี่ยนหัวหน้ากลุ่มสาระได้จากหน้าจัดการกลุ่มสาระ
- **แสดงครูในกลุ่มสาระ**: แสดงครูทั้งหมดที่เกี่ยวข้องกับกลุ่มสาระ
- **จัดการวิชาที่สอน**: สามารถดูและจัดการวิชาที่ครูแต่ละคนสอนในกลุ่มสาระ

### 3. ข้อจำกัดและกฎเกณฑ์
- **ครู 1 คน = 1 กลุ่มสาระ**: ครูหนึ่งคนสามารถเป็นหัวหน้าได้เพียง 1 กลุ่มสาระเท่านั้น
- **กลุ่มสาระ 1 กลุ่ม = 1 หัวหน้า**: กลุ่มสาระหนึ่งกลุ่มต้องมีหัวหน้า 1 คนเท่านั้น
- **การลบกลุ่มสาระ**: เมื่อถอดหัวหน้าออก กลุ่มสาระจะถูกลบ (เนื่องจากไม่สามารถมีกลุ่มสาระที่ไม่มีหัวหน้าได้)

## ไฟล์ที่ได้สร้าง/แก้ไข

### ไฟล์ใหม่
- `src/components/Admin/SubjectGroup/AddTeacherToGroupModal.tsx` - Modal สำหรับเปลี่ยนหัวหน้ากลุ่มสาระ

### ไฟล์ที่แก้ไข
- `src/components/Admin/Teacher/TeacherList.tsx` - ปรับปรุงการแสดงกลุ่มสาระและสถิติ
- `src/components/Admin/Teacher/ManageSubjectGroupModal.tsx` - ปรับปรุงการถอดออกจากกลุ่มสาระ
- `src/components/Admin/Teacher/AddTeacherModal.tsx` - เพิ่มข้อความแจ้งเตือนเรื่องกลุ่มสาระ
- `src/components/Admin/SubjectGroup/SubjectGroupList.tsx` - เพิ่มปุ่มเปลี่ยนหัวหน้า

## การทำงานของระบบ

### จากหน้าจัดการบุคลากร
1. **ดูสถานะ**: ดูได้ว่าครูเป็นหัวหน้ากลุ่มสาระใด
2. **จัดการกลุ่มสาระ**: คลิก "จัดการกลุ่มสาระ" เพื่อ:
   - มอบหมายให้เป็นหัวหน้ากลุ่มสาระใหม่
   - เปลี่ยนกลุ่มสาระ
   - ถอดออกจากกลุ่มสาระ (จะลบกลุ่มสาระด้วย)

### จากหน้าจัดการกลุ่มสาระ
1. **ดูหัวหน้า**: ดูได้ว่าใครเป็นหัวหน้ากลุ่มสาระ
2. **เปลี่ยนหัวหน้า**: คลิก "เปลี่ยนหัวหน้า" เพื่อเลือกครูคนใหม่
3. **ดูครูในกลุ่ม**: ดูครูทั้งหมดที่สอนในกลุ่มสาระนั้น

### การสร้างครูใหม่
- ไม่จำเป็นต้องระบุกลุ่มสาระ
- สามารถมาเพิ่มกลุ่มสาระทีหลังได้
- ระบบจะแสดงสถานะ "ไม่ได้เป็นหัวหน้ากลุ่มสาระ"

## ข้อดีของระบบใหม่
1. **ความยืดหยุ่น**: สร้างครูก่อน เพิ่มกลุ่มสาระทีหลัง
2. **การจัดการที่ง่าย**: สามารถจัดการได้จากทั้งสองหน้า
3. **ข้อมูลชัดเจน**: แสดงสถานะและสถิติครบถ้วน
4. **ป้องกันข้อผิดพลาด**: มีการตรวจสอบข้อจำกัดต่างๆ
5. **UX ที่ดี**: มี confirmation dialog และ loading states

## API Endpoints ที่ใช้
- `GET /api/admin/teachers?includeStats=true` - ดึงข้อมูลครูพร้อมสถิติ
- `GET /api/admin/teachers?availableOnly=true` - ดึงครูที่ยังไม่เป็นหัวหน้า
- `PUT /api/admin/subject-groups/[id]` - อัปเดตหัวหน้ากลุ่มสาระ
- `DELETE /api/admin/subject-groups/[id]` - ลบกลุ่มสาระ